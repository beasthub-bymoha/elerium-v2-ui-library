--// SERVICES
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local lp = Players.LocalPlayer

--// GLOBALS
getgenv().targ = nil
getgenv().Hunting = false
getgenv().BountyEarned = 0
local StartTime = os.time()

--// SAFE ZONE CHECK
local SafeZones
pcall(function()
    SafeZones = workspace._WorldOrigin.SafeZones
end)

local function IsInSafeZone(char)
    if not SafeZones or not char or not char:FindFirstChild("HumanoidRootPart") then
        return false
    end

    for _, zone in pairs(SafeZones:GetChildren()) do
        if zone:IsA("BasePart") then
            if (zone.Position - char.HumanoidRootPart.Position).Magnitude < 350 then
                return true
            end
        end
    end
    return false
end

--// SKIP TARGET
function skipTarget()
    getgenv().targ = nil
    getgenv().Hunting = false
    task.wait(0.3)
    game:GetService("TeleportService"):Teleport(game.PlaceId, lp)
end

--// ANTI SAFEZONE LOOP
task.spawn(function()
    while task.wait(1) do
        if getgenv().targ and getgenv().targ.Character then
            local char = getgenv().targ.Character

            -- SafeZone detected
            if IsInSafeZone(char) then
                skipTarget()
            end

            -- PvP disabled
            local gui = lp.PlayerGui:FindFirstChild("Main")
            if gui and gui:FindFirstChild("PvpDisabled") and gui.PvpDisabled.Visible then
                skipTarget()
            end
        end
    end
end)

--// GUI
local GUI = Instance.new("ScreenGui")
GUI.Name = "SCP_HUB_INFO"
GUI.Parent = lp.PlayerGui

local Frame = Instance.new("Frame", GUI)
Frame.Size = UDim2.new(0, 330, 0, 190)
Frame.Position = UDim2.new(0.02, 0, 0.35, 0)
Frame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Draggable = true

local UICorner = Instance.new("UICorner", Frame)
UICorner.CornerRadius = UDim.new(0, 10)

local function makeLabel(text, y, size, color)
    local l = Instance.new("TextLabel", Frame)
    l.Size = UDim2.new(1, -20, 0, size)
    l.Position = UDim2.new(0, 10, 0, y)
    l.BackgroundTransparency = 1
    l.TextXAlignment = Enum.TextXAlignment.Left
    l.Font = Enum.Font.GothamBold
    l.TextSize = size - 4
    l.TextColor3 = color
    l.Text = text
    return l
end

local Title = makeLabel(" SCP HUB | AUTO BOUNTY", 12, 30, Color3.fromRGB(255,170,0))
local TargetLabel = makeLabel("Target : None", 55, 24, Color3.fromRGB(230,230,230))
local BountyLabel = makeLabel("Bounty Earned : 0", 85, 24, Color3.fromRGB(0,255,150))
local TimeLabel = makeLabel("Time Hunting : 0s", 115, 24, Color3.fromRGB(180,180,180))
local StatusLabel = makeLabel("Status : Searching...", 145, 22, Color3.fromRGB(255,100,100))

--// GUI UPDATE LOOP
task.spawn(function()
    while task.wait(1) do
        TargetLabel.Text = "Target : " .. (getgenv().targ and getgenv().targ.Name or "None")
        BountyLabel.Text = "Bounty Earned : " .. tostring(getgenv().BountyEarned)
        TimeLabel.Text = "Time Hunting : " .. (os.time() - StartTime) .. "s"
        StatusLabel.Text = getgenv().Hunting and "Status : Fighting" or "Status : Searching..."
    end
end)

local OldBounty = lp.leaderstats.Bounty.Value
lp.leaderstats.Bounty:GetPropertyChangedSignal("Value"):Connect(function()
    local New = lp.leaderstats.Bounty.Value
    if New > OldBounty then
        getgenv().BountyEarned += (New - OldBounty)
    end
    OldBounty = New
end)
